<?php

namespace App\Http\Validations\DummyClass;

use Validator;
use Illuminate\Http\Request;
use Illuminate\Validation\ValidationException;
use Illuminate\Foundation\Validation\ValidatesRequests;

class DummyName
{
    use ValidatesRequests;

    public function __construct(Request $request)
    {
        if ( ! $this->authorize()) {
            abort(403);
        }

        $this->validate($request);
    }

    /**
     * [authorize description].
     *
     * @return [type] [description]
     */
    protected function authorize()
    {
        return true;
    }

    /**
     * [validate description].
     *
     * @param [type] $request [description]
     *
     * @return [type] [description]
     */
    protected function validate($request)
    {
        $rules = [
            // ...
        ];

        $validator = Validator::make($request->all(), $rules);

        $validator->after(function ($validator) use ($request) {
            // ...
        });

        if ($validator->fails()) {
            throw new ValidationException(
                $validator,
                $this->buildFailedValidationResponse(
                    $request,
                    $validator->errors()->getMessages()
                )
            );
        }
    }
}
